{"ast":null,"code":"import _classCallCheck from\"/Users/Lingo/Rong/JavaScript/26_portfolio/gaze_project/gaze/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/Lingo/Rong/JavaScript/26_portfolio/gaze_project/gaze/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/Lingo/Rong/JavaScript/26_portfolio/gaze_project/gaze/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/Lingo/Rong/JavaScript/26_portfolio/gaze_project/gaze/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/Lingo/Rong/JavaScript/26_portfolio/gaze_project/gaze/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";/* jsx-a11y/no-static-element-interactions */import React,{Component,Fragment}from'react';import'./Home.css';import Search from'../search/Search';import Loading from'../loading/Loading';import Masonry from'react-masonry-css';import Fade from'react-reveal/Fade';import Selector from'../../containers/SelectorContainer';var Home=/*#__PURE__*/function(_Component){_inherits(Home,_Component);function Home(props){var _this;_classCallCheck(this,Home);_this=_possibleConstructorReturn(this,_getPrototypeOf(Home).call(this,props));_this.handleSearchTxt=function(item){_this.setState({searchTxt:item});};_this.handleScroll=function(){// topSearchBar\nvar showTopSearch=_this.props.showTopSearch;if(document.documentElement.scrollTop>250){showTopSearch(true);}else{showTopSearch(false);}// 下拉加載\nvar scrollTop=document.documentElement.scrollTop;var clientHeight=document.documentElement.clientHeight;var scrollHeight=document.documentElement.scrollHeight;if(scrollHeight-clientHeight===scrollTop){var page=_this.state.page;var _this$props=_this.props,getImgsList=_this$props.getImgsList,queryTxt=_this$props.queryTxt,getRandomImgs=_this$props.getRandomImgs,totalPage=_this$props.totalPage,isLoadingRandomImgs=_this$props.isLoadingRandomImgs,isLoadingGetImgs=_this$props.isLoadingGetImgs;if(totalPage!==0&&page!==totalPage){if(queryTxt===''){if(!isLoadingRandomImgs){getRandomImgs(page+1);_this.setState(function(prevState){return{page:prevState.page+1};});}}else{if(!isLoadingGetImgs){getImgsList(page+1,queryTxt);_this.setState(function(prevState){return{page:prevState.page+1};});}}}}};_this.handleHoverOut=function(){_this.setState({hoveredImg:''});};_this.handleClose=function(){_this.setState({showSelector:false});document.body.style.overflow=\"visible\";};_this.state={page:1,// 目前的頁碼\nhoveredImg:'',previewId:'',// createName:'',\n// editMode: false,\nsearchTxt:_this.props.match.params.query===undefined?'':_this.props.match.params.query};return _this;}_createClass(Home,[{key:\"componentDidMount\",value:function componentDidMount(){var _this$props2=this.props,getImgsList=_this$props2.getImgsList,query=_this$props2.query,getRandomImgs=_this$props2.getRandomImgs,getSynonymList=_this$props2.getSynonymList,initImgs=_this$props2.initImgs,showTopSearch=_this$props2.showTopSearch;var page=this.state.page;window.addEventListener('scroll',this.handleScroll);window.addEventListener('scroll',this.handleLoandMore);showTopSearch(false);if(this.props.match.params.query!==undefined){//依照關鍵字搜尋\ninitImgs([]);query(this.props.match.params.query);getSynonymList(this.props.match.params.query);getImgsList(page,this.props.match.params.query);}else{//隨機搜尋\nquery('');initImgs([]);getRandomImgs(page);}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){window.removeEventListener('scroll',this.handleScroll);window.removeEventListener('scroll',this.handleLoandMore);}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){var _this$props3=this.props,isLoadingSaveImg=_this$props3.isLoadingSaveImg,getImgsList=_this$props3.getImgsList,query=_this$props3.query,getSynonymList=_this$props3.getSynonymList,initImgs=_this$props3.initImgs;var _this$state=this.state,page=_this$state.page,searchTxt=_this$state.searchTxt;if(prevProps.isLoadingSaveImg===true&&isLoadingSaveImg===false){this.setState({showSelector:false});document.body.style.overflow=\"visible\";}if(prevState.searchTxt!==searchTxt){initImgs([]);query(searchTxt);getSynonymList(searchTxt);//找同義詞\ngetImgsList(page,searchTxt);}}},{key:\"handleHoverOver\",value:function handleHoverOver(id){this.setState({hoveredImg:id});}},{key:\"handleSelector\",value:function handleSelector(id){this.setState({previewId:id,showSelector:true});document.body.style.overflow=\"hidden\";// alert('ok')\n}},{key:\"render\",value:function render(){var _this2=this;var _this$state2=this.state,page=_this$state2.page,previewId=_this$state2.previewId,showSelector=_this$state2.showSelector,hoveredImg=_this$state2.hoveredImg;var _this$props4=this.props,history=_this$props4.history,imgs=_this$props4.imgs,isLoadingGetImgs=_this$props4.isLoadingGetImgs,query=_this$props4.query,queryTxt=_this$props4.queryTxt,getImgsList=_this$props4.getImgsList,initImgs=_this$props4.initImgs,isLoadingRandomImgs=_this$props4.isLoadingRandomImgs,syn=_this$props4.syn,isLoadingSynonym=_this$props4.isLoadingSynonym,getSynonymList=_this$props4.getSynonymList,isAuthenticated=_this$props4.isAuthenticated,totalPage=_this$props4.totalPage;var breakpointColumnsObj={default:3,1100:2,700:1};return React.createElement(Fragment,null,React.createElement(\"div\",{className:\"container\"},showSelector&&React.createElement(Selector,{showSelector:true,previewId:previewId,handleClose:this.handleClose}),React.createElement(Search,{query:query,queryTxt:queryTxt,getImgsList:getImgsList,page:page,initImgs:initImgs,history:history,syn:syn,isLoadingSynonym:isLoadingSynonym,getSynonymList:getSynonymList,handleSearchTxt:this.handleSearchTxt}),isLoadingGetImgs?React.createElement(Loading,null):React.createElement(\"ul\",null,React.createElement(Masonry,{breakpointCols:breakpointColumnsObj,className:\"my-masonry-grid\",columnClassName:\"my-masonry-grid_column\"},imgs.map(function(item,index){if(index>0&&imgs[index]){return React.createElement(\"div\",{className:\"outter\",onMouseOver:function onMouseOver(){return _this2.handleHoverOver(imgs[index].id);},onMouseOut:_this2.handleHoverOut},React.createElement(\"button\",{className:hoveredImg===imgs[index].id?'save_button':'hide_style',onClick:isAuthenticated?function(){return _this2.handleSelector(imgs[index].id);}:function(){return history.push('/login');}},React.createElement(\"i\",{class:\"fas fa-plus\"})),React.createElement(Fade,{bottom:true,duration:600},React.createElement(\"li\",{key:imgs[index].id,role:\"presentation\",onClick:function onClick(){return history.push(\"/images/\".concat(imgs[index].id));}},React.createElement(\"div\",{className:hoveredImg===imgs[index].id?'hover_layer':'hide_style'}),React.createElement(\"img\",{src:imgs[index].urls.regular,alt:\"\"}))));}})),totalPage===0&&React.createElement(\"div\",{className:\"empt_notice\"},\"No results found, please try different keyword.\"),page===totalPage&&React.createElement(\"div\",{className:\"empt_notice\"},\"\".concat(page,\" / \").concat(totalPage)))));}}]);return Home;}(Component);export default Home;","map":{"version":3,"sources":["/Users/Lingo/Rong/JavaScript/26_portfolio/gaze_project/gaze/src/components/home/Home.js"],"names":["React","Component","Fragment","Search","Loading","Masonry","Fade","Selector","Home","props","handleSearchTxt","item","setState","searchTxt","handleScroll","showTopSearch","document","documentElement","scrollTop","clientHeight","scrollHeight","page","state","getImgsList","queryTxt","getRandomImgs","totalPage","isLoadingRandomImgs","isLoadingGetImgs","prevState","handleHoverOut","hoveredImg","handleClose","showSelector","body","style","overflow","previewId","match","params","query","undefined","getSynonymList","initImgs","window","addEventListener","handleLoandMore","removeEventListener","prevProps","isLoadingSaveImg","id","history","imgs","syn","isLoadingSynonym","isAuthenticated","breakpointColumnsObj","default","map","index","handleHoverOver","handleSelector","push","urls","regular"],"mappings":"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","sourcesContent":["/* jsx-a11y/no-static-element-interactions */\n\nimport React, { Component, Fragment } from 'react';\nimport './Home.css';\nimport Search from '../search/Search'\nimport Loading from '../loading/Loading';\nimport Masonry from 'react-masonry-css'\nimport Fade from 'react-reveal/Fade';\nimport Selector from '../../containers/SelectorContainer'\n\n\n\nclass Home extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      page: 1, // 目前的頁碼\n      hoveredImg: '',\n      previewId:'',\n      // createName:'',\n      // editMode: false,\n      searchTxt: this.props.match.params.query === undefined ? '' : this.props.match.params.query,\n    };\n  }\n\n  componentDidMount() {\n    const { getImgsList,query,getRandomImgs, getSynonymList,initImgs,showTopSearch} = this.props;\n    const { page} = this.state;\n    window.addEventListener('scroll', this.handleScroll);\n    window.addEventListener('scroll', this.handleLoandMore);\n    showTopSearch(false);\n\n    if(this.props.match.params.query !== undefined) { //依照關鍵字搜尋\n      initImgs([])\n      query(this.props.match.params.query)\n      getSynonymList(this.props.match.params.query)\n      getImgsList(page, this.props.match.params.query);\n    } else { //隨機搜尋\n      query('')\n      initImgs([])\n      getRandomImgs(page)\n    }\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('scroll', this.handleScroll);\n    window.removeEventListener('scroll', this.handleLoandMore);\n  }\n\n  componentDidUpdate(prevProps,prevState) {\n    const { isLoadingSaveImg,getImgsList,query, getSynonymList,initImgs} = this.props;\n    const { page,searchTxt } = this.state;\n\n    if (prevProps.isLoadingSaveImg === true && isLoadingSaveImg === false) {\n      this.setState({\n        showSelector:false,\n      })\n      document.body.style.overflow = \"visible\"\n    }\n    if (prevState.searchTxt !== searchTxt) {\n      initImgs([])\n      query(searchTxt)\n      getSynonymList(searchTxt) //找同義詞\n      getImgsList(page, searchTxt);\n    }\n  }\n\n  handleSearchTxt = (item) => {\n    this.setState({\n      searchTxt: item,\n    })\n  }\n\n  handleScroll = () => {\n    // topSearchBar\n    const { showTopSearch } = this.props\n    if( document.documentElement.scrollTop > 250) {\n      showTopSearch(true);\n    } else {\n      showTopSearch(false);\n    }\n    // 下拉加載\n    const scrollTop = document.documentElement.scrollTop;\n    const clientHeight = document.documentElement.clientHeight;\n    const scrollHeight = document.documentElement.scrollHeight;\n    if (scrollHeight-clientHeight === scrollTop) {\n      const { page } = this.state;\n      const { getImgsList,queryTxt,getRandomImgs,totalPage,isLoadingRandomImgs,isLoadingGetImgs } = this.props;\n      if(totalPage !== 0 && page !== totalPage){\n        if(queryTxt === ''){\n          if(!isLoadingRandomImgs){\n            getRandomImgs(page + 1)\n            this.setState((prevState) => ({\n              page: prevState.page + 1,\n            }));\n          }\n        } else {\n          if(!isLoadingGetImgs){\n            getImgsList(page + 1, queryTxt);\n            this.setState((prevState) => ({\n              page: prevState.page + 1,\n            }));\n          }\n        }\n      }\n    }\n  }\n\n  handleHoverOver(id){\n    this.setState({\n      hoveredImg: id,\n    })\n  }\n\n  handleHoverOut = () => {\n    this.setState({\n      hoveredImg: ''\n    })\n  }\n\n  handleSelector(id){\n    this.setState({\n      previewId: id,\n      showSelector: true,\n    })\n    document.body.style.overflow = \"hidden\"\n    // alert('ok')\n  }\n\n  handleClose = () => {\n    this.setState({\n      showSelector:false,\n    })\n    document.body.style.overflow = \"visible\"\n  }\n\n  render() {\n    \n    const { page,previewId,showSelector,hoveredImg } = this.state;\n    const { history, imgs, isLoadingGetImgs,query,queryTxt,getImgsList,initImgs, isLoadingRandomImgs,syn,isLoadingSynonym, getSynonymList, isAuthenticated,totalPage} = this.props;\n    const breakpointColumnsObj = {\n      default: 3,\n      1100: 2,\n      700: 1\n    };\n    return (\n      <Fragment>\n        <div className=\"container\" >\n          {showSelector && <Selector showSelector = {true}  previewId={previewId} \n          handleClose={this.handleClose}/>}\n\n          <Search query={query} queryTxt={queryTxt} getImgsList={getImgsList} page={page} initImgs={initImgs} history={history} syn={syn} isLoadingSynonym={isLoadingSynonym} getSynonymList={getSynonymList}\n          handleSearchTxt={this.handleSearchTxt}\n          />\n          {isLoadingGetImgs ? <Loading /> :\n          <ul>\n            <Masonry\n              breakpointCols={breakpointColumnsObj}\n              className=\"my-masonry-grid\"\n              columnClassName=\"my-masonry-grid_column\"\n            >\n              {imgs.map((item, index) => {\n                  if (index > 0 && imgs[index]) {\n                    return (\n                      <div className=\"outter\"                           \n                      onMouseOver={() => this.handleHoverOver(imgs[index].id)}\n                      onMouseOut={this.handleHoverOut}>\n                        <button className={hoveredImg === imgs[index].id? 'save_button':'hide_style'} \n                        onClick={isAuthenticated ? () => this.handleSelector(imgs[index].id) : ()=> history.push('/login')}><i class=\"fas fa-plus\"></i></button>\n                        <Fade bottom duration={600} >\n                          <li key={imgs[index].id} role=\"presentation\" \n                          onClick={() => history.push(`/images/${imgs[index].id}`)}>\n                            <div className={hoveredImg === imgs[index].id? 'hover_layer':'hide_style'}></div>\n                            <img src={imgs[index].urls.regular} alt=\"\" />\n                          </li>\n                        </Fade>\n                      </div>\n                    );\n                  }\n                })\n              }\n            </Masonry>\n            {totalPage === 0 && <div className=\"empt_notice\">No results found, please try different keyword.</div>}\n            {page === totalPage && <div className=\"empt_notice\">{`${page} / ${totalPage}`}</div>}\n          </ul>\n          }\n        </div>\n      </Fragment>\n    );\n  }\n}\nexport default Home;\n"]},"metadata":{},"sourceType":"module"}