{"ast":null,"code":"var _jsxFileName = \"/Users/Lingo/Rong/JavaScript/26_portfolio/gaze_project/gaze/src/components/singlePage/SinglePage.js\";\n\n/* jsx-a11y/no-static-element-interactions */\nimport React, { Component, Fragment } from 'react';\nimport './SinglePage.css';\nimport { withRouter } from 'react-router-dom';\nimport Loading from '../loading/Loading';\nimport Masonry from 'react-masonry-css';\nimport Fade from 'react-reveal/Fade';\nimport Selector from '../../containers/SelectorContainer';\n\nclass SinglePage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleHoverOut = () => {\n      this.setState({\n        hoveredImg: ''\n      });\n    };\n\n    this.handleClose = () => {\n      this.setState({\n        showSelector: false\n      });\n      document.body.style.overflow = \"visible\";\n    };\n\n    this.state = {\n      page: 1,\n      hoveredImg: '',\n      previewId: '',\n      currentImgId: this.props.match.params.imgId\n    };\n    const initImgs = this.props.initImgs;\n    initImgs([]);\n  }\n\n  componentDidMount() {\n    const currentImgId = this.state.currentImgId;\n    const getSingleImg = this.props.getSingleImg;\n    getSingleImg(currentImgId); // window.addEventListener('scroll', this.handlePageScroll);\n  } // componentWillUnmount() {\n  //   window.removeEventListener('scroll', this.handlePageScroll);\n  // }\n\n\n  componentDidUpdate(prevProps, prevState) {\n    const currentImgId = this.state.currentImgId;\n    const _this$props = this.props,\n          isLoadingSingleImg = _this$props.isLoadingSingleImg,\n          getImgsList = _this$props.getImgsList,\n          singleImg = _this$props.singleImg,\n          getSingleImg = _this$props.getSingleImg,\n          isLoadingSaveImg = _this$props.isLoadingSaveImg,\n          initImgs = _this$props.initImgs;\n\n    if (prevProps.isLoadingSingleImg === true && isLoadingSingleImg === false) {\n      getImgsList(1, singleImg.tags[0].title);\n      console.log(singleImg.tags[0].title);\n    }\n\n    if (prevState.currentImgId !== currentImgId) {\n      window.location.reload(); // initImgs([]);\n      // getSingleImg(currentImgId );\n    }\n\n    if (prevProps.isLoadingSaveImg === true && isLoadingSaveImg === false) {\n      this.setState({\n        showSelector: false\n      });\n      document.body.style.overflow = \"visible\";\n    }\n  } // handlePageScroll = () => {\n  //   // 下拉加載\n  //   const scrollTop = document.documentElement.scrollTop;\n  //   const clientHeight = document.documentElement.clientHeight;\n  //   const scrollHeight = document.documentElement.scrollHeight;\n  //   if (scrollHeight-clientHeight === scrollTop) {\n  //     const { page } = this.state;\n  //     const { getImgsList,singleImg,isLoadingGetImgs} = this.props;\n  //     if(!isLoadingGetImgs && singleImg.tags){\n  //       getImgsList(page + 1,singleImg.tags[0].title)\n  //       this.setState((prevState) => ({\n  //         page: prevState.page + 1,\n  //       }))\n  //     }\n  //   }\n  // }\n\n\n  handleHoverOver(id) {\n    this.setState({\n      hoveredImg: id\n    });\n  }\n\n  handleSumbit(id) {\n    const history = this.props.history;\n    this.setState({\n      currentImgId: id\n    });\n    history.push(\"/images/\".concat(id));\n  }\n\n  handleSelector(id) {\n    this.setState({\n      previewId: id,\n      showSelector: true\n    });\n    document.body.style.overflow = \"hidden\";\n  }\n\n  render() {\n    const _this$state = this.state,\n          page = _this$state.page,\n          hasMore = _this$state.hasMore,\n          previewId = _this$state.previewId,\n          showSelector = _this$state.showSelector,\n          hoveredImg = _this$state.hoveredImg,\n          createName = _this$state.createName,\n          editMode = _this$state.editMode;\n    const _this$props2 = this.props,\n          singleImg = _this$props2.singleImg,\n          isLoadingSingleImg = _this$props2.isLoadingSingleImg,\n          history = _this$props2.history,\n          imgs = _this$props2.imgs,\n          isLoadingGetImgs = _this$props2.isLoadingGetImgs,\n          isAuthenticated = _this$props2.isAuthenticated,\n          totalPage = _this$props2.totalPage;\n    const breakpointColumnsObj = {\n      default: 4,\n      1100: 2,\n      700: 1\n    };\n    const singlePhoto = React.createElement(Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, !isLoadingSingleImg && singleImg.urls ? React.createElement(\"div\", {\n      className: \"single_container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      className: \"single_img\",\n      src: singleImg.urls.regular,\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"single_info\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"save_button_dark\",\n      onClick: isAuthenticated ? () => this.handleSelector(singleImg.id) : () => history.push('/login'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      class: \"fas fa-plus\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      class: \"tag_group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"subtitle\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, \"Uploaded by\"), React.createElement(\"div\", {\n      className: \"creater\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      className: \"create_profile\",\n      src: singleImg.user.profile_image.medium,\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      className: \"creater_name\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, singleImg.user.name)), React.createElement(\"p\", {\n      className: \"subtitle\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, \"Related tags\"), React.createElement(\"ul\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, singleImg.tags.map((item, index) => {\n      if (index > 0 && index < 7 && singleImg.tags[index]) {\n        return React.createElement(\"li\", {\n          className: \"single_tag\",\n          style: {\n            backgroundColor: [singleImg.color]\n          },\n          onClick: () => history.push(\"/search/\".concat(singleImg.tags[index].title)),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 137\n          },\n          __self: this\n        }, singleImg.tags[index].title);\n      }\n    }))))) : React.createElement(Loading, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }));\n    const relatedImg = React.createElement(\"ul\", {\n      className: \"related_images\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, React.createElement(Masonry, {\n      breakpointCols: breakpointColumnsObj,\n      className: \"my-masonry-grid\",\n      columnClassName: \"my-masonry-grid_column\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, imgs ? imgs.map((item, index) => {\n      if (imgs[index]) {\n        return React.createElement(\"div\", {\n          className: \"outter\",\n          onMouseOver: () => this.handleHoverOver(imgs[index].id),\n          onMouseOut: this.handleHoverOut,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 161\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          className: hoveredImg === imgs[index].id ? 'save_button' : 'hide_style',\n          onClick: isAuthenticated ? () => this.handleSelector(imgs[index].id) : () => history.push('/login'),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165\n          },\n          __self: this\n        }, React.createElement(\"i\", {\n          class: \"fas fa-plus\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 166\n          },\n          __self: this\n        })), React.createElement(Fade, {\n          bottom: true,\n          duration: 600,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 168\n          },\n          __self: this\n        }, React.createElement(\"li\", {\n          key: imgs[index].id,\n          role: \"presentation\",\n          onClick: () => this.handleSumbit(imgs[index].id),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 169\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: hoveredImg === imgs[index].id ? 'hover_layer' : 'hide_style',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171\n          },\n          __self: this\n        }), React.createElement(\"img\", {\n          src: imgs[index].urls.regular,\n          alt: \"\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 172\n          },\n          __self: this\n        }))));\n      }\n    }) : React.createElement(Loading, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    })));\n    return React.createElement(Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, showSelector && React.createElement(Selector, {\n      showSelector: true,\n      previewId: previewId,\n      handleClose: this.handleClose,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, singlePhoto, relatedImg));\n  }\n\n}\n\nexport default withRouter(SinglePage);","map":{"version":3,"sources":["/Users/Lingo/Rong/JavaScript/26_portfolio/gaze_project/gaze/src/components/singlePage/SinglePage.js"],"names":["React","Component","Fragment","withRouter","Loading","Masonry","Fade","Selector","SinglePage","constructor","props","handleHoverOut","setState","hoveredImg","handleClose","showSelector","document","body","style","overflow","state","page","previewId","currentImgId","match","params","imgId","initImgs","componentDidMount","getSingleImg","componentDidUpdate","prevProps","prevState","isLoadingSingleImg","getImgsList","singleImg","isLoadingSaveImg","tags","title","console","log","window","location","reload","handleHoverOver","id","handleSumbit","history","push","handleSelector","render","hasMore","createName","editMode","imgs","isLoadingGetImgs","isAuthenticated","totalPage","breakpointColumnsObj","default","singlePhoto","urls","regular","user","profile_image","medium","name","map","item","index","backgroundColor","color","relatedImg"],"mappings":"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","sourcesContent":["/* jsx-a11y/no-static-element-interactions */\n\nimport React, { Component, Fragment } from 'react';\nimport './SinglePage.css';\nimport { withRouter } from 'react-router-dom';\nimport Loading from '../loading/Loading';\nimport Masonry from 'react-masonry-css';\nimport Fade from 'react-reveal/Fade';\nimport Selector from '../../containers/SelectorContainer'\n\nclass SinglePage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      page: 1,\n      hoveredImg: '',\n      previewId:'',\n      currentImgId: this.props.match.params.imgId,\n    };\n    const {initImgs } = this.props;\n    initImgs([]);\n  }\n\n  componentDidMount() {\n    const { currentImgId } = this.state;\n    const { getSingleImg, } = this.props;\n    getSingleImg(currentImgId );\n    // window.addEventListener('scroll', this.handlePageScroll);\n  }\n\n  // componentWillUnmount() {\n  //   window.removeEventListener('scroll', this.handlePageScroll);\n  // }\n\n  componentDidUpdate(prevProps,prevState) {\n    const { currentImgId } = this.state;\n    const { isLoadingSingleImg,getImgsList,singleImg,getSingleImg,isLoadingSaveImg,initImgs } = this.props;\n    if (prevProps.isLoadingSingleImg === true && isLoadingSingleImg === false) {\n      getImgsList(1,singleImg.tags[0].title)\n      console.log(singleImg.tags[0].title);\n    }\n    if (prevState.currentImgId !== currentImgId) {\n      window.location.reload()\n      // initImgs([]);\n      // getSingleImg(currentImgId );\n    }\n    if (prevProps.isLoadingSaveImg === true && isLoadingSaveImg === false) {\n      this.setState({\n        showSelector:false,\n      })\n      document.body.style.overflow = \"visible\"\n    }\n  }\n\n  // handlePageScroll = () => {\n  //   // 下拉加載\n  //   const scrollTop = document.documentElement.scrollTop;\n  //   const clientHeight = document.documentElement.clientHeight;\n  //   const scrollHeight = document.documentElement.scrollHeight;\n  //   if (scrollHeight-clientHeight === scrollTop) {\n  //     const { page } = this.state;\n  //     const { getImgsList,singleImg,isLoadingGetImgs} = this.props;\n  //     if(!isLoadingGetImgs && singleImg.tags){\n  //       getImgsList(page + 1,singleImg.tags[0].title)\n  //       this.setState((prevState) => ({\n  //         page: prevState.page + 1,\n  //       }))\n  //     }\n  //   }\n  // }\n\n  handleHoverOver(id){\n    this.setState({\n      hoveredImg: id,\n    })\n  }\n\n  handleHoverOut = () => {\n    this.setState({\n      hoveredImg: ''\n    })\n  }\n\n  handleSumbit(id) {\n    const {history} =  this.props\n    this.setState({\n      currentImgId: id,\n    })\n    history.push(`/images/${id}`)\n  }\n\n  handleSelector(id){\n    this.setState({\n      previewId: id,\n      showSelector: true,\n    })\n    document.body.style.overflow = \"hidden\"\n  }\n\n  handleClose = () => {\n    this.setState({\n      showSelector:false,\n    })\n    document.body.style.overflow = \"visible\"\n  }\n\n\n\n  render() {\n    const { page,hasMore,previewId,showSelector,hoveredImg,createName,editMode} = this.state;\n\n    const { singleImg, isLoadingSingleImg,history,imgs,isLoadingGetImgs,isAuthenticated,totalPage }= this.props;\n    const breakpointColumnsObj = {\n      default: 4,\n      1100: 2,\n      700: 1\n    };\n    \n    const singlePhoto = (\n      <Fragment>\n        {!isLoadingSingleImg && singleImg.urls ?\n          <div className=\"single_container\">\n            <img className=\"single_img\" src={singleImg.urls.regular} alt=\"\"/>\n            <div className=\"single_info\">\n              <button className='save_button_dark' onClick={isAuthenticated ? () => this.handleSelector(singleImg.id) : ()=> history.push('/login')}><i class=\"fas fa-plus\"></i></button>\n              <div class=\"tag_group\">\n                <p className=\"subtitle\">Uploaded by</p>\n                <div className=\"creater\">\n                  <img className=\"create_profile\" src={singleImg.user.profile_image.medium} alt=\"\" />\n                  <p className=\"creater_name\">{singleImg.user.name}</p>\n                </div>\n                <p className=\"subtitle\">Related tags</p>\n                <ul>\n                  {singleImg.tags.map((item, index) => {\n                      if ( index > 0 && index < 7  && singleImg.tags[index]) {\n                        return (\n                          <li className=\"single_tag\" style={{ backgroundColor: [singleImg.color]}}\n                          onClick={() => history.push(`/search/${singleImg.tags[index].title}`)}>{singleImg.tags[index].title}</li>\n                        )\n                      }\n                    })\n                  }\n                </ul>\n              </div>\n            </div>\n          </div>\n        : <Loading />}\n      </Fragment>\n    );\n\n    const relatedImg = (\n      <ul className=\"related_images\">\n        <Masonry\n          breakpointCols={breakpointColumnsObj}\n          className=\"my-masonry-grid\"\n          columnClassName=\"my-masonry-grid_column\"\n        >\n          {imgs ? imgs.map((item, index) => {\n            if (imgs[index]) {\n              return (\n                <div className=\"outter\"                           \n                  onMouseOver={() => this.handleHoverOver(imgs[index].id)}\n                  onMouseOut={this.handleHoverOut}\n                >\n                  <button className={hoveredImg === imgs[index].id? 'save_button':'hide_style'} \n                  onClick={isAuthenticated ? () => this.handleSelector(imgs[index].id) : ()=> history.push('/login')}><i class=\"fas fa-plus\"></i></button>\n\n                  <Fade bottom duration={600} >\n                    <li key={imgs[index].id} role=\"presentation\" \n                    onClick={() => this.handleSumbit(imgs[index].id)}>\n                      <div className={hoveredImg === imgs[index].id? 'hover_layer':'hide_style'}></div>\n                      <img src={imgs[index].urls.regular} alt=\"\" />\n                    </li>\n                  </Fade>\n                </div>\n              );\n            }\n          }): <Loading />}\n        </Masonry>\n      </ul>\n    )\n    \n    return (\n      <Fragment>\n        {showSelector && <Selector showSelector = {true}  previewId={previewId} \n        handleClose={this.handleClose}/>}\n        <div className=\"container\">\n          {singlePhoto}\n          {relatedImg}\n        </div>\n      </Fragment>\n    );\n  }\n}\nexport default withRouter(SinglePage);\n"]},"metadata":{},"sourceType":"module"}